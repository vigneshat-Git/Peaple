<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Peaple - Video Chat</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="Peaple_header-logo.svg">

  <!-- <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js"></script> -->
<!-- <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-auth.js"></script> -->
<!-- <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-firestore.js"></script> -->
<!-- <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-analytics.js"></script> -->
<!-- <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-storage.js"></script> -->
<!-- <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-messaging.js"></script> -->
<!-- <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-functions.js"></script> -->
<!-- <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-database.js"></script> -->
<!-- <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-performance.js"></script> -->
<!-- <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-remote-config.js"></script> -->
<!-- <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-app-check.js"></script> -->
<!-- <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-installations.js"></script> -->
<script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-auth-compat.js"></script>
<script>
// Initialize Firebase Auth object for browser
if (!firebase.apps.length) {
  firebase.initializeApp({
    apiKey: "AIzaSyCnUEkbwEYruJ0YvbQkjFC9yfMDJsLqOlo",
    authDomain: "peaple-c3f4b.firebaseapp.com",
    projectId: "peaple-c3f4b",
    storageBucket: "peaple-c3f4b.firebasestorage.app",
    messagingSenderId: "814546020627",
    appId: "1:814546020627:web:c43c90fe6af9a0359e52e6",
    measurementId: "G-KHQMHRZ08F"
  });
}
window.auth = firebase.auth(); // Make auth globally available
</script>
 
  
  <style>
    .messages-container {
      width: 100%;
      height: 220px;
      overflow-y: auto;
      border: 1px solid #ccc;
      background: #f7f7fa;
      padding: 8px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .message {
      max-width: 70%;
      padding: 8px 14px;
      border-radius: 18px;
      font-size: 1em;
      word-break: break-word;
      margin-bottom: 2px;
      display: inline-block;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    }
    .message.sent {
      background: linear-gradient(135deg, #d1f7c4 0%, #b2f1a6 100%);
      color: #222;
      align-self: flex-end;
      border-bottom-right-radius: 4px;
      border-bottom-left-radius: 18px;
    }
    .message.received {
      background: #fff;
      color: #222;
      align-self: flex-start;
      border-bottom-left-radius: 4px;
      border-bottom-right-radius: 18px;
      border: 1px solid #e0e0e0;
    }
    .input-container {
      display: flex;
      gap: 8px;
      margin-top: 8px;
    }
    #messageInput {
      flex: 1;
      border-radius: 18px;
      border: 1px solid #ccc;
      padding: 8px 14px;
      font-size: 1em;
      outline: none;
      background: #fff;
    }
    #sendButton {
      border-radius: 18px;
      background: #4caf50;
      color: #fff;
      border: none;
      padding: 8px 18px;
      font-size: 1em;
      cursor: pointer;
      transition: background 0.2s;
    }
    #sendButton:hover {
      background: #388e3c;
    }
    .local-video-pip {
      position: absolute;
      bottom: 18px;
      right: 18px;
      width: 72px !important;
      height: 48px !important;
      z-index: 3;
      background: #e0e0e0;
      border-radius: 10px;
      object-fit: cover;
      box-shadow: 0 2px 8px rgba(0,0,0,0.18);
      transition: width 0.25s cubic-bezier(.4,2,.6,1), height 0.25s cubic-bezier(.4,2,.6,1), box-shadow 0.18s;
      cursor: pointer;
      display: block;
      transform: scaleX(-1);
    }
    .local-video-pip:hover {
      width: 120px !important;
      height: 80px !important;
      box-shadow: 0 4px 16px rgba(0,0,0,0.22);
    }
    .local-video-placeholder {
      position: absolute;
      bottom: 18px;
      right: 18px;
      width: 72px;
      height: 48px;
      z-index: 4;
      background: #e0e0e0;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: none;
      transition: width 0.25s, height 0.25s;
    }
    .local-video-pip:hover + .local-video-placeholder,
    .local-video-placeholder:hover {
      width: 120px;
      height: 80px;
    }
    .local-video-placeholder svg {
      width: 28px;
      height: 28px;
      color: #888;
      opacity: 0.7;
    }
    .local-video-pip.active + .local-video-placeholder {
      display: none !important;
    }
  </style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-container">
      <div class="header_logo">
        <img class="header_logo_img" src="Peaple_header-logo.svg" alt="Peaple Logo">
      </div>
      <div class="profile">
        <div class="profile-dropdown-wrapper" style="position:relative;">
          <img class="profileIcon" src="https://i.pravatar.cc/40" alt="Profile" id="profileIcon">
          <div class="profile-dropdown" id="profileDropdown" style="display:none; position:absolute; right:0; top:52px; background:#fff; box-shadow:0 4px 16px rgba(0,0,0,0.12); border-radius:10px; min-width:180px; z-index:100;">
            <a href="login.html" class="dropdown-item"><i class="fa-solid fa-user fa-fw"></i> Profile</a>
            <a href="#" class="dropdown-item"><i class="fa-solid fa-crown fa-fw"></i> Subscription</a>
            <a href="#" class="dropdown-item"><i class="fa-solid fa-coins fa-fw"></i> Peas</a>
            <a href="#" class="dropdown-item"><i class="fa-solid fa-headset fa-fw"></i> Support</a>
            <a href="#" class="dropdown-item"><i class="fa-solid fa-file-lines fa-fw"></i> Terms & FAQ</a>
            <button onclick="auth.signOut().then(() => window.location.href = 'login.html')" class="dropdown-item" style="background:none; border:none; padding:0; font: inherit; color: inherit; cursor: pointer;">
  <i class="fa-solid fa-right-from-bracket fa-fw"></i> Log out
</button>          </div>
        </div>
        <i class="fa-duotone fa-solid fa-bars fa-lg"></i>
      </div>
    </div>
  </header>

  <!-- Banner -->
  <section class="banner">
    <div class="slides" id="slideContainer">
      <div class="slide">
        <img src="Untitled.jpeg" alt="slide1">
        <div class="slideText">
          <h2>Connect with top professionals</h2>
          <p>Grow your network via Peaple.<br>Know how our network works</p>
          <a href="#" class="banner-btn">Learn more</a>
        </div>
      </div>
      <div class="slide">
        <img src="Untitled1.jpeg" alt="slide2">
        <div class="slideText">
          <h2>Peaple is free</h2>
          <p>Try our new premium plans</p>
          <a href="#" class="banner-btn">Subscribe</a>
        </div>
      </div>
      <div class="slide">
        <img src="Untitled2.jpeg" alt="slide3">
        <div class="slideText">
          <h2>DOT is hiring</h2>
          <p>Get job offers at DOT. Your dreams are nearer</p>
          <a href="#" class="banner-btn">Apply</a>
        </div>
      </div>
    </div>
  </section>

  <!-- Profile & Weekly Report Section -->
  <section class="profile-report-section">
    <div class="profile-card">
      <div class="profile-cover">
        <img class="profile-pic" src="https://i.pravatar.cc/100" alt="Profile">
      </div>
      <div class="profile-card-content">
        <h2>User Name</h2>
        <div class="profile-title">Professional Title</div>
        <div class="professionalism-meter">
          <label>Professionalism Meter</label>
          <div class="professionalism-bar-bg">
            <div class="professionalism-bar"></div>
          </div>
        </div>
        <div class="peas-balance-row">
          <span>Peas Balance:</span>
          <span class="peas-count">120</span>
        </div>
        <a href="#" class="transaction-link">View Transaction History</a>
        <a href="#" class="buy-peas-btn">Buy Peas</a>
      </div>
    </div>
    <div class="weekly-report-card">
      <h2>This Week's Report</h2>
      <div>Connections made: <strong>8</strong></div>
      <div>Peas earned: <strong>35</strong></div>
      <div>Calls duration: <strong>2h 15m</strong></div>
      <div>Professionalism change: <strong>+5%</strong></div>
    </div>
  </section>

  <!-- Call Section -->
  <section class="call-section">
    <div class="call-header">
      <h1>Connect Now</h1>
      <div class="live-users"><i class="fa-solid fa-user"></i><span> 24</span> online</div>
    </div>
    <div class="call-main">
      <div class="search-people">
        <h3>Search People</h3>
        <input type="text" placeholder="Search users..." class="search-bar">
        <div class="search-results">
          <!-- Example user -->
          <div class="user-result">
            <img src="https://i.pravatar.cc/40" alt="User">
            <span>User Name</span>
            <span class="user-prof">Professional</span>
          </div>
        </div>
      </div>
      <div class="video-call">
        <h3>Video Call</h3>
        <div class="video-area">
          <div style="position:relative;width:100%;aspect-ratio:16/9;max-width:520px;margin:auto;">
            <video id="remoteVideo" autoplay style="z-index:1;width:100%;height:100%;background:#000;border-radius:16px;object-fit:cover;display:block;"></video>
            <div id="remoteOverlay" style="position:absolute;top:0;left:0;width:100%;height:100%;display:none;align-items:center;justify-content:center;color:gray;font-size:1.2em;z-index:2;pointer-events:none;">Waiting for People</div>
            <video id="localVideo" autoplay muted class="local-video-pip"></video>
            <div id="localVideoPlaceholder" class="local-video-placeholder">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M4 6a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2V8a2 2 0 00-2-2H4z" />
              </svg>
            </div>
          </div>
        </div>
        <div class="call-tools">
          <div style="display:flex;justify-content:center;align-items:center;gap:18px;width:100%;">
            <button id="muteButton" title="Mute" style="background:none;border:none;cursor:pointer;padding:0;display:flex;align-items:center;">
              <i id="muteIcon" class="fa-solid fa-microphone" style="font-size:1.1em;color:#333;"></i>
            </button>
            <button id="startButton" style="display:flex;align-items:center;">Start Call</button>
            <button id="endButton" title="End Call" style="background:none;border:none;cursor:pointer;display:none;padding:0;display:flex;align-items:center;">
              <i class="fa-solid fa-phone-slash" style="font-size:1.1em;color:#e53935;"></i>
            </button>
            <button id="screenShareButton" title="Share Screen" style="background:none;border:none;cursor:pointer;padding:0;display:flex;align-items:center;">
              <i class="fa-solid fa-display" style="font-size:1.1em;color:#333;"></i>
            </button>
            <button id="settingsButton" title="Settings" style="background:none;border:none;cursor:pointer;padding:0;display:flex;align-items:center;">
              <i class="fa-solid fa-gear" style="font-size:1.1em;color:#333;"></i>
            </button>
          </div>
        </div>
      </div>
      <div class="chat-box">
        <h3>Chat</h3>
        <div id="messagesContainer" class="messages-container" style="width:100%;height:220px;overflow-y:auto;border:1px solid #ccc;background:#fff;padding:8px;box-sizing:border-box;"></div>
        <div class="input-container" style="display:flex;gap:8px;">
          <input type="text" id="messageInput" placeholder="Type a message..." style="flex:1;">
          <button id="sendButton">Send</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Recent Connections -->
  <section class="recent-connections">
    <h2>Recent Connections</h2>
    <div class="connection-list">
      <div class="connection-item">
        <img src="https://i.pravatar.cc/40" alt="User">
        <div class="conn-info">
          <span>User Name</span>
          <span class="user-prof">Professional</span>
        </div>
        <div class="conn-meta">
          <span>2 days ago</span>
          <button class="reconnect-btn">Reconnect</button>
        </div>
      </div>
      <div class="connection-item">
        <img src="https://i.pravatar.cc/40" alt="User">
        <div class="conn-info">
          <span>User Name</span>
          <span class="user-prof">Professional</span>
        </div>
        <div class="conn-meta">
          <span>5 hr ago</span>
          <button class="reconnect-btn">Reconnect</button>
        </div>
      </div>
    </div>
    <a href="#" class="view-all-connections">View all connections</a>
  </section>

  <!-- Feedback Section -->
  <section class="feedback-section">
    <h2>Feedback</h2>
    <div class="feedback-list">
      <div class="feedback-item">
        <span>User Name</span>
        <span>⭐⭐⭐⭐⭐</span>
        <span>Great call experience!</span>
      </div>
      <div class="feedback-item">
        <span>User Name</span>
        <span>⭐⭐⭐⭐</span>
        <span>Good, but can improve.</span>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <script>
      // Banner slider functionality
      const slides = document.getElementById("slideContainer");
      let currentSlide = 0;
      function updateSlidePosition() {
        slides.style.transform = `translateX(-${currentSlide * 100}%)`;
      }
      setInterval(() => {
        currentSlide = (currentSlide + 1) % slides.children.length;
        updateSlidePosition();
      }, 3000);

      // Profile dropdown functionality
      const profileIcon = document.getElementById('profileIcon');
      const profileDropdown = document.getElementById('profileDropdown');
      profileIcon.addEventListener('click', function(e) {
        e.stopPropagation();
        const isOpen = profileDropdown.style.display === 'block';
        profileDropdown.style.display = isOpen ? 'none' : 'block';
        if (!isOpen) {
          profileIcon.classList.add('profile-focused');
        } else {
          profileIcon.classList.remove('profile-focused');
        }
      });
      document.addEventListener('click', function(e) {
        if (profileDropdown.style.display === 'block') {
          profileDropdown.style.display = 'none';
          profileIcon.classList.remove('profile-focused');
        }
      });
    </script>
    <div class="footer-main">
      <div class="footer-features">
        <h4>Product Features</h4>
        <a href="#">Pricing</a>
        <a href="#">FAQ</a>
      </div>
      <div class="footer-company">
        <h4>Company</h4>
        <a href="#">About</a>
        <a href="#">Careers</a>
        <a href="#">Contact</a>
      </div>
      <div class="footer-legal">
        <h4>Legal</h4>
        <a href="#">Privacy</a>
        <a href="#">Terms</a>
        <a href="#">Cookie Policy</a>
      </div>
      <div class="footer-social">
        <h4>Follow Us</h4>
        <a href=" https://x.com/SoulTechYT2?t=dtXMcyBBl-tE33wNeMJSRg&s=08 "><i class="fa-brands fa-x-twitter fa-lg"></i></a>
        <a href="https://www.linkedin.com/in/vignesh-p-2a05b0254?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app"><i class="fa-brands fa-linkedin-in fa-lg"></i></a>
        <a href="https://www.instagram.com/vixin.debian?igsh=cDZuNDhoNGIyc21t"><i class="fa-brands fa-instagram fa-lg"></i></a>
        <a href="https://www.facebook.com/share/1JH7zF32ho/?mibextid=qi2Omg"><i class="fa-brands fa-facebook-f fa-lg"></i></a>
      </div>
    </div>
    <div class="footer-copyright">
      &copy; 2025 Peaple. All rights reserved.
    </div>
  </footer>
</body>

<script>

// Modal logic for login/register
const modalHtml = `
  <div id="loginRegisterModal" class="modal-overlay" style="display:none;">
    <div class="modal-window">
      <h2 class="modal-title">Log in to make call</h2>
      <div class="modal-section">
        <div class="modal-desc">If you already have an account, then</div>
        <button class="modal-btn" id="modalLoginBtn">Log In</button>
      </div>
      <div class="modal-or"><span>or</span></div>
      <div class="modal-section">
        <div class="modal-desc">New here? Join as Peaple!</div>
        <button class="modal-btn" id="modalRegisterBtn">Register</button>
      </div>
      <button class="modal-close" id="modalCloseBtn">&times;</button>
    </div>
  </div>
`;
document.body.insertAdjacentHTML('beforeend', modalHtml);

// Modal CSS
const modalStyle = document.createElement('style');
modalStyle.innerHTML = `
  .modal-overlay {
    position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
    background: rgba(0,0,0,0.35); display: flex; align-items: center; justify-content: center; z-index: 9999;
  }
  .modal-window {
    background: #fff; border-radius: 18px; box-shadow: 0 8px 32px rgba(0,0,0,0.18);
    padding: 36px 32px 24px 32px; min-width: 320px; max-width: 90vw; position: relative; text-align: center;
    animation: modalPop 0.2s cubic-bezier(.4,2,.6,1) 1;
  }
  @keyframes modalPop { from { transform: scale(0.92); opacity: 0; } to { transform: scale(1); opacity: 1; } }
  .modal-title { font-size: 1.5rem; font-weight: 700; margin-bottom: 18px; color: #2db2ff; }
  .modal-section { margin-bottom: 18px; }
  .modal-desc { font-size: 1.08rem; color: #444; margin-bottom: 10px; }
  .modal-btn {
    width: 100%; padding: 10px 0; border-radius: 8px; border: none; font-size: 1.08rem; font-weight: 600;
    background: linear-gradient(90deg, #2db2ff 60%, #09ff00 100%); color: #fff; margin-bottom: 4px; cursor: pointer;
    transition: background 0.18s, color 0.18s, transform 0.18s;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
  }
  .modal-btn:hover { background: #249643; color: #fff; transform: scale(1.04); }
  .modal-or { margin: 10px 0 18px 0; position: relative; text-align: center; }
  .modal-or span { background: #fff; padding: 0 12px; color: #aaa; font-size: 1rem; position: relative; z-index: 1; }
  .modal-or:before { content: ""; display: block; position: absolute; top: 50%; left: 0; right: 0; height: 1px; background: #eee; z-index: 0; }
  .modal-close {
    position: absolute; top: 10px; right: 16px; background: none; border: none; font-size: 1.6rem; color: #aaa; cursor: pointer;
    transition: color 0.18s;
  }
  .modal-close:hover { color: #e53935; }
`;
document.head.appendChild(modalStyle);

// Modal JS logic
const modal = document.getElementById('loginRegisterModal');
const openModal = () => { modal.style.display = 'flex'; };
const closeModal = () => { modal.style.display = 'none'; };
document.getElementById('modalCloseBtn').onclick = closeModal;
document.getElementById('modalLoginBtn').onclick = () => { window.location.href = 'login.html#login'; };
document.getElementById('modalRegisterBtn').onclick = () => { window.location.href = 'login.html#register'; };
window.addEventListener('keydown', (e) => { if (modal.style.display === 'flex' && e.key === 'Escape') closeModal(); });

// Start Call button logic
const startBtn = document.getElementById('startButton');
if (startBtn) {
  startBtn.addEventListener('click', function(e) {
    auth.onAuthStateChanged((user) => {
      if (!user) {
        openModal();
      } else {
        // Place your start call logic here for logged-in users
      }
    });
  });
}


// Prevent call/camera if not logged in, show modal instead
if (startBtn) {
  startBtn.addEventListener('click', function(e) {
    e.preventDefault();
    auth.onAuthStateChanged((user) => {
      if (!user) {
        openModal();
      } else {
        // Only here should you start the call and request camera/mic
        if (typeof startCallIfAuthenticated === 'function') {
          startCallIfAuthenticated();
        }
      }
    });
  });
}
</script>


<script src="client.js"></script>
</html>
